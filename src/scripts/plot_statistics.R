#theme
theme_set(theme_bw() + theme(
  plot.title = element_text(size = 30, hjust = 0.5),
  panel.grid.major = element_line(color = "gray70", size = 0.1),
  panel.grid.minor = element_blank(),
  axis.text.x = element_text(colour = "black", size = 35, hjust = .5, vjust = .5, face = "plain"),
  axis.text.y = element_text(colour = "black", size = 40, hjust = .5, vjust = .5, face = "plain"),
  axis.title.x = element_text(colour = "black", face="bold",size = 50, angle = 0, hjust = .5, vjust = 0),
  axis.title.y = element_text(colour = "black", face="bold", size = 50, angle = 90, hjust = .5, vjust = .5),
  legend.position="top",legend.title=element_text(size=32),legend.text = element_text(size=32),
  legend.box.background = element_rect(colour = "black",size=1.5),
  strip.background = element_rect(fill = "gray95"),
  strip.text.x = element_text(size = 32, face="bold")
))


topnone <- c(79.325,64.185,29.97,49.296,32.08,44.045,57.897,57.076,423.573,69.892,27.68,14.098,65.201,47.153,25.576,57.201,44.607,67.35,76.267,39.098,57.999,38.016,47.544,43.827,22.843,57.559,67.937,53.287,111.985,34.611,124.978,33.495,42.497,34.312,56.646,84.075,27.013,180.725,23.194,33.771,30.772,34.082,62.073,92.768,53.794,80.854,35.754,129.378,33.184,60.504,48.749,19.651,41.443,53.966,57.55,43.432,46.567,61.716,82.708,97.28,57.882,102.494,65.005,25.856,65.222,60.582,61.713,81.935,110.257,81.181,50.292,54.139,31.66,116.318,117.08,45.575,31.948,108.465,62.741,95.532,32.145,170.526,44.351,125.381,46.86,14.802,69.738,98.439,39.402,78.359,54.635,65.205,75.277,28.743,35.503,53.976,126.613,30.062,32.089,44.561,79.603,78.932,68.829,62.728,109.258,56.413,32.084,50.622,19.295,94.759,101.049,67.561,44.521,33.455,58.554,50.549,91.755,206.241,88.35,51.36,68.1,62.362,123.055,37.211,57.753,131.7,36.327,46.62,61.906,146.007,58.012,54.823,79.323,47.339,26.034,62.581,113.035,45.732,663.718,31.244,42.356,66.94,53.933,64.783,47.209,36.981,106.086,56.237,68.377,173.971,30.196,46.41,58.988,27.742,49.178,49.75,86.94,73.511,49.673,40.509,137.028,74.004,96.878,79.96,123.292,56.139,47.004,72.39,81.878,79.519,181.958,67.575,114.305,81.467,62.564,246.801,28.814,95.065,15.99,60.405,49.37,86.171,27.967,73.109,54.049,19.775,28.562,44.912,33.448,67.971,81.977,63.299,39.924,30.111,60.802,47.434,36.16,60.026,54.486,200.202,52.003,57.13,74.565,47.498,132.278,50.392,25.311,46.808,70.179,74.05,37.751,58.143,276.127,34.821,27.631,26.553,96.829,85.141,48.618,193.242,34.063,63.689,58.818,95.768,80.05,40.574,36.252,53.749,62.319,31.696,12.189,70.112,68.542,134.269,45.136,46.964,58.635,44.224,108.381,40.203)
toptop <- c(44.749,74.396,104.198,110.388,110.362,57.682,114.655,115.899,56.869,131.597,31.13,78.817,86.572,70.085,136.91,110.12,58.68,78.453,58.19,61.095,48.223,70.574,110.713,75.31,31.693,81.351,81.989,67.787,31.03,124.635,66.29,46.306,59.647,66.712,71.517,83.125,48.428,31.589,74.987,66.345,217.897,87.463,96.456,73.149,67.497,76.167,184.898,107.394,149.815,75.387,75.392,41.68,135.262,111.586,242.867,108.302,123.249,103.567,48.692,75.604,58.792,74.797,96.049,32.439,62.294,120.512,108.612,54.366,84.62,469.849,36.377,63.668,89.79,71.53,70.091,113.871,67.439,51.117,132.77,71.16,90.799,98.653,76.179,159.141,131.91,77.566,44.723,111.828,193.767,129.101,119.409,103.971,53.115,58.676,133.099,90.34,78.591,76.849,69.727,244.025,258.772,22.843,102.484,85.06,76.264,69.035,41.877,77.224,65.499,83.219,56.77,76.479,74.956,69.199,89.544,83.929,85.212,106.065,47.136,61.249,75.756,151.079,236.147,82.655,65.604,88.316,207.221,96.44,83.717,100.814,95.333,117.341,96.546,164.478,91.36,121.885,85.151,87.189,160.305,52.002,170.652,102.077,47.987,127.35,104.674,72.794,65.092,182.839,549.381,50.479,147.324,125.646,94.931,76.688,66.477,167.052,78.831,209.213,73.357,77.33,130.896,49.781,75.14,49.979,97.274,85.842,100.084,60.728,58.598,163.171,94.447,83.711,55.063,67.24,51.02,122.593,93.193,105.745,25.976,113.292,122.479,48.648,190.261,82.19,106.311,214.689,97.237,232.12,194.409,63.517,63.451,58.406,114.134,100.325,54.668,91.67,64.688,100.753,67.761,58.116,37.886,36.92,114.166,102.871,110.399,144.838,113.371,164.882,34.518,95.94,45.122,95.211,90.94,39.713,73.897,92.355,87.758,72.781,95.011,49.011,110.6,94.019,79.047,57.021,76.456,54.634,54.648,50.2,43.622,62.262,50.579,18.877,116.684,22.932,63.791,55.016,79.972,91.851,75.678,79.22)
toprank <- c(57.093,39.609,28.853,59.576,52.459,112.649,78.236,146.784,68.037,126.73,100.745,133.867,550.21,150.492,54.337,100.007,352.927,134.216,105.213,108.05,62.379,84.612,88.546,26.452,60.06,164.486,74.509,65.837,95.218,204.51,169.381,101.61,38.949,58.745,34.85,181.447,148.595,98.126,59.58,127.583,71.485,133.949,89.86,139.58,109.562,108.437,134.581,121.711,156.797,145.23,193.935,141.379,50.878,90.686,72.114,180.801,247.096,113.47,85.989,125.768,78.857,99.865,130.513,71.116,60.95,135.707,262,147.35,174.715,80.517,72.464,42.071,127.313,85.138,78.784,101.524,154.905,139.93,217.847,117.722,94.918,72.839,165.651,95.475,270.167,77.499,97.868,111.603,89.049,83.667,129.021,120.467,174.166,243.793,76.63,111.777,134.73,120.01,97.901,111.215,22.324,241.551,90.798,113.718,95.108,48.746,151.244,93.682,165.731,108.568,69.256,132.005,138.186,61.252,35.286,136.323,114.016,313.021,97.561,69.267,109.398,125.299,169.48,212.342,287.022,114.896,85.558,73.924,79.281,88.422,107.868,84.79,45.651,86.281,129.555,85.818,154.549,230.207,130.441,76.019,126.018,307.087,78.862,295.621,165.096,196.228,76.764,118.182,105.334,104.097,245.31,125.86,91.901,135.465,141.289,242.321,123.88,184.462,211.579,92.05,64.742,90.914,225.373,103.446,68.809,86.844,135.126,133.384,93.772,157.953,39.356,81.841,126.223,168.999,407.644,60.21,81.78,108.169,66.809,181.848,115.759,91.759,98.092,64.69,179.11,175.69,33.992,69.061,54.105,109.199,117.03,351.938,121.236,61.96,175.079,127.812,57.144,340.071,73.662,76.816,71.879,183.253,106.139,357.862,88.601,347.354,65.105,146.329,165.151,105.26,148.168,208.62,108.752,84.15,72.661,142.831,149.2,75.501,112.009,136.416,52.503,94.443,129.354,77.742,139.938,120.901,29.158,167.737,77.68,76.786,87.139,227.89,81.832,101.791,130.829,153.037,84.237,142.74,128.361,80.895)
ranknone <- c(51.714,94.809,44.092,38.794,24.382,29.155,85.798,109.472,50.995,189.115,114.866,133.471,59.839,39.99,15.069,80.441,79.079,108.088,41.838,21.988,41.044,80.447,92.488,92.594,98.541,148.277,70.46,13.819,108.43,49.483,116.069,46.291,81.007,59.766,12.461,48.106,23.581,81.372,76.335,155.149,93.592,30.639,21.855,69.151,66.802,89.165,78.487,48.808,32.164,59.771,50.146,23.172,107.281,43.818,62.706,220.039,39.463,71.419,37.972,83.817,59.871,59.995,67.651,51.066,94.557,44.035,77.802,90.554,37.151,41.78,69.813,127.851,195.409,102.521,44.539,94.582,62.338,51.339,100.798,78.837,47.903,70.339,40.097,89.74,65.386,102.611,62.54,134.099,79.699,101.155,151.578,80.074,53.065,167.318,69.154,234.27,61.665,97.631,90.763,19.463,108.508,59.826,65.277,73.03,170.041,68.123,136.071,54.241,44.686,42.764,156.095,74.725,66.106,48.766,58.188,94.112,250.169,52.63,66.388,58.592,146.218,56.855,78.17,111.312,88.057,74.116,86.165,266.715,111.207,152.076,106.805,86.611,103.139,130.546,60.545,123.68,84.558,63.06,91.394,86.126,18.662,77.973,111.448,181.887,48.783,47.349,96.515,116.941,79.201,51.024,64.033,102.471,67.672,61.585,45.44,63.441,105.258,63.175,49.229,83.692,127.323,41.678,67.858,80.539,53.308,70.675,92.807,59.655,96.148,83.761,50.169,65.438,49.477,126.088,287.21,43.269,153.881,64.823,54.525,23.404,39.581,43.925,63.514,53.583,130.042,135.222,16.286,83.294,77.665,45.206,31.796,58.482,131.196,101.445,38.568,101.968,213.573,121.401,66.823,116.89,64.489,96.684,297.935,94.203,66.7,42.76,90.706,83.312,84.713,50.309,191.584,85.048,187.082,43.586,172.047,87.862,155.615,73.245,113.811,48.838,107.552,82.524,132.75,24.612,73.025,77.289,63.893,193.978,103.39,45.912,77.654,66.19,81.588,99.775,87.774,63.509,48.171,138.263,84.987,96.455)
ranktop <- c(60.807,564.714,65.344,93.894,42.104,52.471,149.084,86.184,119.328,54.898,93.084,72.692,52.68,91.138,150.312,46.225,83.031,255.644,67.097,86.137,70.306,76.775,21.445,58.436,157.057,86.477,66.641,65.574,33.545,88.925,49.981,98.506,85.337,81.489,146.653,68.626,53.078,31.623,78.615,129.499,63.448,152.677,151.674,274.002,70.17,221.19,91.983,68.542,135.049,161.55,88.431,133.516,78.565,67.072,116.207,300.008,65.646,185.512,82.676,81.879,148.436,96.013,87.394,79.449,66.705,142.737,101.952,135.569,145.63,152.507,223.968,184.086,158.786,147.489,189.419,157.536,103.364,345.997,159.753,217.487,144.271,134.378,65.843,96.276,79.611,130.545,243.068,45.558,97.629,140.656,148.1,58.706,190.334,161.08,97.295,281.887,93.537,193.532,76.563,128.819,309.403,109.464,118.489,198.473,25.726,189.879,84.191,92.296,51.21,105.935,49.868,192.862,73.303,140.651,149.395,144.696,132.089,119.831,207.919,189.665,127.54,66.574,92.319,102.103,107.697,266.905,135.644,538.598,114.269,160.595,72.076,115.56,141.087,134.324,113.734,131.571,78.183,110.87,52.207,88.229,246.389,166.473,118.943,102.736,156.015,102.184,72.031,119.865,44.239,194.239,115.34,168.375,105.693,275.165,113.399,241.695,71.473,80.04,68.41,125.408,104.358,101.32,96.267,97.285,79.238,141.913,156.172,138.335,74.521,184.572,112.688,132.573,100.472,40.519,88.306,150.765,182.429,212.039,30.85,81.248,189.855,70.064,41.061,105.311,118.541,53.214,84.561,203.038,127.353,45.981,89.928,54.91,77.596,136.2,114.212,173.24,48.173,78.697,147.248,85.714,98.086,120.862,82.527,100.587,57.102,164.011,157.5,163.125,148.547,128.708,110.924,139.859,214.453,85.254,130.698,145.343,115.261,71.739,255.773,94.316,90.019,133.649,136.61,90.493,61.02,59.313,136.092,152.061,75.571,54.268,66.17,106.099,126.722,150.064,92.771,53.225,65.635,37.297,52.603,116.841)
rankrank <- c(142.733,137.007,66.669,128.106,70.514,223.057,35.697,245.757,98.621,95.396,153.658,201.929,153.593,149.006,125.611,52.95,202.56,89.375,170.049,76.314,154.038,89.997,101.857,100.481,66.775,54.604,141.551,52.029,61.878,88.303,72.139,82.811,74.089,52.569,104.076,157.942,213.878,35.5,89.699,91.961,64.532,96.255,168.658,107.664,165.929,78.068,41.769,165.419,73.862,54.459,67.348,157.485,85.205,180.466,424.509,143.401,99.487,145.153,224.326,86.783,94.266,142.318,163.363,128.133,113.799,426.471,533.538,163.887,148.423,143.85,258.065,156.542,320.101,50.563,166.735,235.272,251.203,113.628,129.348,111.247,101.757,277.57,216.418,116.786,223.814,68.413,160.917,18.979,87.586,108.02,35.364,178.586,140.493,115.919,86.351,330.391,115.803,186.601,117.596,77.904,219.942,222.273,101.665,101.861,86.672,74.529,116.063,119.209,177.784,178.887,188.809,79.846,131.484,120.565,120.014,94.859,245.781,238.404,110.45,135.453,98.294,236.059,132.258,196.635,126.898,104.734,98.106,268.553,115.336,299.914,179.502,107.463,194.384,107.336,98.303,168.41,149.459,146.873,117.91,225.582,170.857,174.08,235.128,147.863,85.239,180.731,149.044,104.461,33.243,89.796,123.417,86.187,95.589,83.167,363.768,265.009,154.604,77.725,50.45,149.929,122.666,146.853,75.728,192.402,77.484,259.662,172.348,397.384,115.34,251.971,120.291,104.313,152.282,276.941,233.622,138.505,100.738,61.695,121.457,107.032,94.05,93.944,199.702,116.975,86.118,77.598,144.876,403.877,218.697,230.606,95.499,237.435,72.043,77.346,133.053,51.815,168.273,127.634,141.168,128.125,143.279,348.736,108.862,123.472,41.444,122.034,146.17,111.351,130.107,107.004,139.052,100.213,224.614,100.369,175.102,328.927,111.101,69.698,193.197,141.582,150.362,146.27,147.996,119.116,73.292,173.907,173.334,70.033,97.65,154.514,99.398,208.091,210.805,131.429,148.131,102.999,84.439,154.09,146.997,92.656)

avgtime = c(mean(topnone), mean(toptop), mean(toprank), mean(ranknone), mean(ranktop), mean(rankrank))
setime = c(sd(topnone), sd(toptop), sd(toprank), sd(ranknone), sd(ranktop), sd(rankrank)) / sqrt(240)
trts = c('Top-None', 'Top-Top', 'Top-Rank', 'Rank-None', 'Rank-Top', 'Rank-Rank')
trts <- factor(trts, levels = trts)

#time spent on tutorials
avgtimetut <- c(25.77849, 54.49568, 119.93981, 58.42065, 95.17493, 114.73925)
setimetut <- c(1.433211, 1.952432, 6.021487, 3.535078, 4.693206, 5.757020)

dftime <- tibble(meantime = c(avgtime, avgtimetut), serr = c(setime, setimetut), treatment = rep(trts, 2), type = c(rep('Five Questions', 6), rep('Tutorial', 6)))
pd <- position_dodge2(0.2)
dftime %>% ggplot(aes(x=treatment, y=meantime, group=type, fill=type)) + 
  geom_col(width = 0.7, position = pd) + 
  geom_errorbar(aes(ymin = meantime - 2*serr, ymax = meantime + 2*serr), width=0.3, size=1, position = position_dodge(width = 0.7)) + 
  scale_fill_brewer(palette = 'Spectral') +
  xlab('Treatment') + ylab('Average Time Spent [sec]') + guides(fill=guide_legend(title="Type"))

#analysis of perceived difficulty
topnone <- c(16.6666666666666,	38.8888888888888,	32.2222222222222,	6.66666666666666,	5.55555555555555)
toptop <- c(19.6078431372549,	33.3333333333333,	19.6078431372549,	24.5098039215686,	2.94117647058823)
toprank <- c(17.4757281553398,	34.9514563106796,	25.2427184466019,	17.4757281553398,	4.85436893203883)
ranknone <- c(28.9999999999999,	39,	18,	11,	3)
ranktop <- c(26.2135922330097,	29.126213592233,	22.3300970873786,	19.4174757281553,	2.9126213592233)
rankrank <- c(18.2692307692307,	31.7307692307692,	26.9230769230769,	17.3076923076923,	5.76923076923076)

types <- c('Very Easy',	'Easy',	'Neutral',	'Difficult',	'Very Difficult')
types <- factor(types, levels = types)
treatment <-  c(rep('Top-None', 5), rep('Top-Top', 5), rep('Top-Rank', 5), rep('Rank-None', 5), rep('Rank-Top', 5), rep('Rank-Rank', 5))
treatment <- factor(treatment, levels = trts)
value <- c(topnone, toptop, toprank, ranknone, ranktop, rankrank)

dfdiff <- tibble(value = value, type = rep(types,6), treatment = treatment)
dfdiff %>% ggplot(aes(x=treatment, y=value, fill=type)) + geom_col(width = 0.7) + scale_fill_brewer(palette = 'Spectral') + xlab('Elicitation Format') + ylab('Percentage of Users') + guides(fill=guide_legend(title="Difficulty"))

#analysis of perceived expressiveness
topnone <- c(15.5555555555555,	27.7777777777777,	33.3333333333333,	20,	3.33333333333333)
toptop <- c(14.7058823529411,	25.4901960784313,	35.2941176470588,	21.5686274509803,	2.94117647058823)
toprank <- c(8.7378640776699,	37.8640776699029,	35.9223300970873,	13.5922330097087,	3.88349514563106)
ranknone <- c(15,	40,	26,	12,	7)
ranktop <- c(22.3300970873786,	17.4757281553398,	32.0388349514563,	22.3300970873786,	5.8252427184466)
rankrank <- c(11.5384615384615,	28.8461538461538,	32.6923076923076,	17.3076923076923,	9.61538461538461)

types <- c('Very Little',	'Little',	'Adequate',	'Significant',	'Very Sig.')
types <- factor(types, levels = types)
value <- c(topnone, toptop, toprank, ranknone, ranktop, rankrank)
dfexpr <- tibble(value = value, type = rep(types,6), treatment = treatment)
dfexpr %>% ggplot(aes(x=treatment, y=value, fill=type)) + geom_col(width = 0.7) + scale_fill_brewer(palette = 'Spectral') + xlab('Elicitation Format') + ylab('Percentage of Users') + guides(fill=guide_legend(title="Expressiveness"))

